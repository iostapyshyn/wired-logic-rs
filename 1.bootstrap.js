(window.webpackJsonp=window.webpackJsonp||[]).push([[1],[,function(e,t,n){"use strict";n.r(t);var r=n(2);const i=document.getElementById("canvas").getContext("2d"),a=document.createElement("canvas").getContext("2d"),o=document.getElementById("delay-range"),c=document.getElementById("delay-value"),s=document.getElementById("pause-button");let u=null,d=1,l={hover:!1,pos:{x:0,y:0},drag:null},h={on:!1,size:1};function f(e){this.circuit=r.b.new(e),this.width=this.circuit.width(),this.height=this.circuit.height(),this.pixels=new ImageData(this.circuit.pixels_view(),this.width,this.height),this.pause=!1,this.delay=0;let t=null,n=()=>{this.pause||this.circuit.tick(),t=setTimeout(n,this.delay)};n(),this.exportDataURL=e=>{const t=document.createElement("canvas").getContext("2d");t.canvas.width=this.width,t.canvas.height=this.height;let n=new ImageData(this.circuit.export(),this.width,this.height);return t.putImageData(n,0,0),t.canvas.toDataURL(e)},this.destroy=()=>{clearTimeout(t),this.circuit.free()}}function p(e){d=e=e>0?e:1,function(){switch(a.canvas.width=u.width,a.canvas.height=u.height,i.canvas.width=u.width*d,i.canvas.height=u.height*d,i.imageSmoothingEnabled=!1,i.fillStyle="white",i.strokeStyle="white",d){case 1:h.size=12;break;case 2:h.size=6;break;case 3:h.size=3;break;case 4:h.size=2;break;default:h.size=1}}()}function g(e){u.delay=e>=0?e:0,o.value=u.delay,c.innerHTML=u.delay+" ms."}function y(e){u.pause=e,u.pause?s.value="play_arrow":s.value="pause"}function m(){if(a.putImageData(u.pixels,0,0),i.clearRect(0,0,u.width*d,u.height*d),i.drawImage(a.canvas,0,0,u.width*d,u.height*d),i.beginPath(),null!==l.drag){const e={x:l.pos.x-l.drag.x,y:l.pos.y-l.drag.y},t={x:l.drag.x,y:l.drag.y},n={x:Math.abs(e.x)>Math.abs(e.y)?l.pos.x:l.drag.x,y:Math.abs(e.x)>Math.abs(e.y)?l.drag.y:l.pos.y};i.rect(t.x*d,t.y*d,d,d),i.rect(t.x*d,t.y*d,(n.x-t.x+1)*d,(n.y-t.y+1)*d),i.rect(n.x*d,n.y*d,d,d)}else l.hover&&(h.on?(i.strokeRect((l.pos.x-h.size/2+.5)*d,(l.pos.y-h.size/2+.5)*d,h.size*d,h.size*d),u.circuit.fill_rect(l.pos.x-Math.floor(h.size/2),l.pos.y-Math.floor(h.size/2),h.size,h.size,r.a.Void)):i.rect(l.pos.x*d,l.pos.y*d,d,d));u.circuit.at((l.drag||l.pos).x,(l.drag||l.pos).y)==r.a.Wire?i.stroke():i.fill(),requestAnimationFrame(m)}function w(){function e(e,t){var n=document.createElement("a");n.href=e,n.download=t,n.click()}o.addEventListener("input",()=>{g(o.value)},!1),document.getElementById("zoom-plus").addEventListener("click",()=>{p(d+1)},!1),document.getElementById("zoom-minus").addEventListener("click",()=>{p(d-1)},!1),s.addEventListener("click",()=>{y(!u.pause)},!1),document.getElementById("new-cancel").addEventListener("click",()=>{document.getElementById("popup-container").style.display="none"},!1),document.getElementById("new-proceed").addEventListener("click",()=>{document.getElementById("popup-container").style.display="none";const e=document.getElementById("new-width").value,t=document.getElementById("new-height").value;isNaN(e)||0==e||isNaN(t)||0==t?alert("Wrong dimensions. Please try again."):(a.canvas.width=e,a.canvas.height=t,a.clearRect(0,0,u.width,u.height),a.canvas.toBlob(e=>{new Response(e).arrayBuffer().then(e=>{v(new Uint8Array(e))})}))},!1),document.getElementById("file-new").addEventListener("click",()=>{document.getElementById("popup-container").style.display="block"},!1),document.getElementById("file-open").addEventListener("click",()=>{!function(e){const t=document.createElement("input");t.type="file",t.addEventListener("change",t=>{const n=t.target.files[0];let r=new FileReader;r.onload=t=>{const n=new Uint8Array(t.target.result);e(n)},r.readAsArrayBuffer(n)},!1),t.click()}(v)},!1),document.getElementById("file-save").addEventListener("click",()=>{e(u.exportDataURL(),"wired-export.png")},!1),document.getElementById("file-export").addEventListener("click",()=>{if(confirm("This operation can take some time on large simulations.\nAre you sure you want to proceed?")){const r=u.circuit.render_gif(parseInt(u.delay));e((t=r,n="image/gif",URL.createObjectURL(new Blob([t.buffer],{type:n}))),"wired-export.gif")}var t,n},!1),document.addEventListener("keydown",e=>{switch(e.key){case" ":y(!u.pause);break;case"+":p(d+1);break;case"-":p(d-1);break;case"x":h.on=!0,l.drag=null;break;case"z":l.hover&&u.circuit.fill_rect(l.pos.x,l.pos.y,2,2,r.a.Wire)}}),document.addEventListener("keyup",e=>{switch(e.key){case"x":h.on=!1}},!1),i.canvas.addEventListener("mouseover",()=>{l.hover=!0},!1),i.canvas.addEventListener("mouseout",()=>{l.hover=!1},!1),document.addEventListener("mousemove",e=>{function t(e,t,n){return Math.min(Math.max(e,t),n)}var n=i.canvas.getBoundingClientRect();l.pos={x:t(Math.floor((e.clientX-n.left)/d),0,u.width-1),y:t(Math.floor((e.clientY-n.top)/d),0,u.height-1)}},!1),document.addEventListener("mousedown",()=>{l.hover&&!h.on&&(l.drag=l.pos)},!1),document.addEventListener("mouseup",()=>{if(null!==l.drag){if(l.hover&&l.drag===l.pos)u.circuit.toggle_pixel(l.pos.x,l.pos.y);else{const e={x:l.pos.x-l.drag.x,y:l.pos.y-l.drag.y},t={x:Math.abs(e.x)>Math.abs(e.y)?l.pos.x:l.drag.x,y:Math.abs(e.x)>Math.abs(e.y)?l.drag.y:l.pos.y};let n=r.a.Wire;u.circuit.at(l.drag.x,l.drag.y)==r.a.Wire&&(n=r.a.Void),u.circuit.draw_line(l.drag.x,l.drag.y,t.x,t.y,n)}l.drag=null}},!1)}function v(e){u&&u.destroy(),u=new f(e),y(!1),g(50),p(1)}let x=new URL(window.location.href).searchParams.get("url");var b,E,k;null==x&&(x="examples/7seg.png"),b=x,E=e=>{v(e),w(),requestAnimationFrame(m)},(k=new XMLHttpRequest).open("GET",b,!0),k.responseType="arraybuffer",k.onreadystatechange=()=>{if(k.response){const e=new Uint8Array(k.response);E(e)}},k.send(null)},function(e,t,n){"use strict";(function(e){n.d(t,"a",(function(){return w})),n.d(t,"b",(function(){return v})),n.d(t,"e",(function(){return x})),n.d(t,"l",(function(){return b})),n.d(t,"k",(function(){return E})),n.d(t,"c",(function(){return k})),n.d(t,"i",(function(){return I})),n.d(t,"g",(function(){return L})),n.d(t,"f",(function(){return B})),n.d(t,"j",(function(){return z})),n.d(t,"d",(function(){return M})),n.d(t,"h",(function(){return _})),n.d(t,"m",(function(){return A}));var r=n(4);const i=new Array(32).fill(void 0);function a(e){return i[e]}i.push(void 0,null,!0,!1);let o=i.length;function c(e){const t=a(e);return function(e){e<36||(i[e]=o,o=e)}(e),t}function s(e){o===i.length&&i.push(i.length+1);const t=o;return o=i[t],i[t]=e,t}let u=new("undefined"==typeof TextDecoder?(0,e.require)("util").TextDecoder:TextDecoder)("utf-8",{ignoreBOM:!0,fatal:!0});u.decode();let d=null;function l(){return null!==d&&d.buffer===r.r.buffer||(d=new Uint8Array(r.r.buffer)),d}function h(e,t){return u.decode(l().subarray(e,e+t))}let f=0;let p=new("undefined"==typeof TextEncoder?(0,e.require)("util").TextEncoder:TextEncoder)("utf-8");const g="function"==typeof p.encodeInto?function(e,t){return p.encodeInto(e,t)}:function(e,t){const n=p.encode(e);return t.set(n),{read:e.length,written:n.length}};let y=null;function m(){return null!==y&&y.buffer===r.r.buffer||(y=new Int32Array(r.r.buffer)),y}const w=Object.freeze({Void:0,0:"Void",Wire:1,1:"Wire"});class v{static __wrap(e){const t=Object.create(v.prototype);return t.ptr=e,t}free(){const e=this.ptr;this.ptr=0,r.a(e)}static new(e){var t=function(e,t){const n=t(1*e.length);return l().set(e,n/1),f=e.length,n}(e,r.c),n=f,i=r.k(t,n);return v.__wrap(i)}tick(){r.o(this.ptr)}at(e,t){return r.e(this.ptr,e,t)>>>0}pixels_view(){return c(r.l(this.ptr))}draw_pixel(e,t,n){r.g(this.ptr,e,t,n)}draw_line(e,t,n,i,a){r.f(this.ptr,e,t,n,i,a)}fill_rect(e,t,n,i,a){r.i(this.ptr,e,t,n,i,a)}toggle_pixel(e,t){r.p(this.ptr,e,t)}export(){return c(r.h(this.ptr))}reset(){r.n(this.ptr)}render_gif(e){return c(r.m(this.ptr,e))}width(){return r.q(this.ptr)>>>0}height(){return r.j(this.ptr)>>>0}}const x=function(e){return s(new Uint8ClampedArray(a(e)))},b=function(e){c(e)},E=function(){return s(r.r)},k=function(e){return s(a(e).buffer)},I=function(e,t,n){return s(new Uint8Array(a(e),t>>>0,n>>>0))},L=function(e){return s(new Uint8Array(a(e)))},B=function(){return s(new Error)},z=function(e,t){var n=function(e,t,n){if(void 0===n){const n=p.encode(e),r=t(n.length);return l().subarray(r,r+n.length).set(n),f=n.length,r}let r=e.length,i=t(r);const a=l();let o=0;for(;o<r;o++){const t=e.charCodeAt(o);if(t>127)break;a[i+o]=t}if(o!==r){0!==o&&(e=e.slice(o)),i=n(i,r,r=o+3*e.length);const t=l().subarray(i+o,i+r);o+=g(e,t).written}return f=o,i}(a(t).stack,r.c,r.d),i=f;m()[e/4+1]=i,m()[e/4+0]=n},M=function(e,t){try{console.error(h(e,t))}finally{r.b(e,t)}},_=function(e,t,n){return s(new Uint8ClampedArray(a(e),t>>>0,n>>>0))},A=function(e,t){throw new Error(h(e,t))}}).call(this,n(3)(e))},function(e,t){e.exports=function(e){if(!e.webpackPolyfill){var t=Object.create(e);t.children||(t.children=[]),Object.defineProperty(t,"loaded",{enumerable:!0,get:function(){return t.l}}),Object.defineProperty(t,"id",{enumerable:!0,get:function(){return t.i}}),Object.defineProperty(t,"exports",{enumerable:!0}),t.webpackPolyfill=1}return t}},function(e,t,n){"use strict";var r=n.w[e.i];e.exports=r;n(2);r.s()}]]);